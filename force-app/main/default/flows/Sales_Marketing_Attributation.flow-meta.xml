<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>49.0</apiVersion>
    <assignments>
        <description>Set the attrib to marketing</description>
        <name>Set_Marketing_Attrib</name>
        <label>Set Marketing Attrib</label>
        <locationX>422</locationX>
        <locationY>854</locationY>
        <assignmentItems>
            <assignToReference>Attributation</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Marketing Influenced</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Sales_Sourced</name>
        <label>Set Sales Sourced</label>
        <locationX>1294</locationX>
        <locationY>658</locationY>
        <assignmentItems>
            <assignToReference>Attributation</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sales Sourced</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <decisions>
        <description>See if there is an MEL Date Match</description>
        <name>Check_MEL_Dates</name>
        <label>Check MEL Dates</label>
        <locationX>226</locationX>
        <locationY>462</locationY>
        <defaultConnector>
            <targetReference>Loop_Through_Opty_Products</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Eductation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Education</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Education_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Education</label>
        </rules>
        <rules>
            <name>FMS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FMS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.FMS_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>FMS</label>
        </rules>
        <rules>
            <name>HCM</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>HCM</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.HCM_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>HCM</label>
        </rules>
        <rules>
            <name>HSC</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>HSC</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.HSC_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>HSC</label>
        </rules>
        <rules>
            <name>NFP</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>NFP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.NFP_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>NFP</label>
        </rules>
        <rules>
            <name>Recruitment</name>
            <conditionLogic>1 AND 2</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Recruitment</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Recruitment_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Recruitment</label>
        </rules>
        <rules>
            <name>SCS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SCS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.SCS_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>SCS</label>
        </rules>
        <rules>
            <name>DLC</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>DLC</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.DLC_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>DLC</label>
        </rules>
        <rules>
            <name>Payments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Payments</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Payments_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Payments</label>
        </rules>
        <rules>
            <name>Hospitality</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Hospitality</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Hospitality_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Hospitality</label>
        </rules>
        <rules>
            <name>Workspace</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Workspace</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Workspace_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Workspace</label>
        </rules>
        <rules>
            <name>CHS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>CHS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.CHS_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>CHS</label>
        </rules>
        <rules>
            <name>Legal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Legal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.Legal_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Legal</label>
        </rules>
        <rules>
            <name>Attache</name>
            <conditionLogic>(1 OR 3) AND 2</conditionLogic>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Attache</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppAccounts.ANZ_Latest_MEL_Date__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>OppCreatedDate30days</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppProduct.Product_Division__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>APAC</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Marketing_Attrib</targetReference>
            </connector>
            <label>Attache</label>
        </rules>
    </decisions>
    <decisions>
        <description>Is there products?</description>
        <name>Check_There_is_products</name>
        <label>Check There is products</label>
        <locationX>656</locationX>
        <locationY>269</locationY>
        <defaultConnector>
            <targetReference>Get_Owner_Details</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Products_not_null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OppProducts</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Through_Opty_Products</targetReference>
            </connector>
            <label>Products not null</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check the user Profile and Role to see if it match&apos;s</description>
        <name>Check_User</name>
        <label>Check User</label>
        <locationX>1060</locationX>
        <locationY>654</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Sales</name>
            <conditionLogic>(1 OR 2 OR 3 OR 6 OR 7 OR 8 OR 9 OR 10 OR 11 OR 12 OR 13) AND( 4 OR 5)</conditionLogic>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e5800000123nV</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e4I000000IoOD</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e5800000123nU</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.UserRoleId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>00E58000000aMQm</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.UserRoleId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>00E58000000aMQl</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000IdJM</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000NWpO</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000F7bL</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000NhBY</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000MeTt</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000NgDs</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000hiYo</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>OppUser.ProfileId</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>00e58000000rpgN</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Sales_Sourced</targetReference>
            </connector>
            <label>Sales</label>
        </rules>
    </decisions>
    <description>Added Attache</description>
    <formulas>
        <description>Opp Created Date minus 30 days</description>
        <name>OppCreatedDate30days</name>
        <dataType>DateTime</dataType>
        <expression>{!IncommingOpp.CreatedDate} - 30</expression>
    </formulas>
    <interviewLabel>Sales - Marketing Attributation {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Sales - Marketing Attributation</label>
    <loops>
        <description>Loop through each product, check the division, see if it has an MEL date and if its 30days from the Opp creation date</description>
        <name>Loop_Through_Opty_Products</name>
        <label>Loop Through Opty Products</label>
        <locationX>666</locationX>
        <locationY>467</locationY>
        <assignNextValueToReference>OppProduct</assignNextValueToReference>
        <collectionReference>OppProducts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_MEL_Dates</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Owner_Details</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <description>Get Account From Op</description>
        <name>Get_Account_From_Op</name>
        <label>Get Account From Op</label>
        <locationX>432</locationX>
        <locationY>69</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Opp_Products</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>IncommingOpp.AccountId</elementReference>
            </value>
        </filters>
        <object>Account</object>
        <outputReference>OppAccounts</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Education_Latest_MEL_Date__c</queriedFields>
        <queriedFields>HCM_Latest_MEL_Date__c</queriedFields>
        <queriedFields>CHS_Latest_MEL_Date__c</queriedFields>
        <queriedFields>HSC_Latest_MEL_Date__c</queriedFields>
        <queriedFields>NFP_Latest_MEL_Date__c</queriedFields>
        <queriedFields>No_Primary_Division_Latest_MEL_Date__c</queriedFields>
        <queriedFields>FMS_Latest_MEL_Date__c</queriedFields>
        <queriedFields>Recruitment_Latest_MEL_Date__c</queriedFields>
        <queriedFields>Hospitality_Latest_MEL_Date__c</queriedFields>
        <queriedFields>SCS_Latest_MEL_Date__c</queriedFields>
        <queriedFields>Workspace_Latest_MEL_Date__c</queriedFields>
        <queriedFields>DLC_Latest_MEL_Date__c</queriedFields>
        <queriedFields>Payments_Latest_MEL_Date__c</queriedFields>
        <queriedFields>Legal_Latest_MEL_Date__c</queriedFields>
        <queriedFields>ANZ_Latest_MEL_Date__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Get all opp products and place in collection varible</description>
        <name>Get_Opp_Products</name>
        <label>Get Opp Products</label>
        <locationX>662</locationX>
        <locationY>71</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_There_is_products</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>IncommingOpp.Id</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>OppProducts</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Product_Division__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Owner_Details</name>
        <label>Get Created By Details</label>
        <locationX>1069</locationX>
        <locationY>464</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>IncommingOpp.CreatedById</elementReference>
            </value>
        </filters>
        <object>User</object>
        <outputReference>OppUser</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>ProfileId</queriedFields>
        <queriedFields>UserRoleId</queriedFields>
    </recordLookups>
    <start>
        <locationX>50</locationX>
        <locationY>51</locationY>
        <connector>
            <targetReference>Get_Account_From_Op</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>Attributation</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>IncommingOpp</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <description>Opportunity Accounts</description>
        <name>OppAccounts</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Account</objectType>
    </variables>
    <variables>
        <description>Single Opp Product</description>
        <name>OppProduct</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>All Opp Products</description>
        <name>OppProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>OppUser</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>User</objectType>
    </variables>
</Flow>
